function isNormalInteger(str){if(!(str=str.trim()))return!1;str=str.replace(/^0+/,"")||"0";var n=Math.floor(Number(str));return n!==1/0&&String(n)===str&&0<=n}function update_group(){let final_group=document.querySelector("#final_group");if(0!=$("tr[id*=group]").length){let result=[];$("tr[id*=group]").each((idx,tr)=>{let ids=[];const id_strs=$(`#${tr.id} td input`)[0].value.split(",");id_strs.filter(e=>e).forEach((idx,element)=>{ids.push(parseInt(element))}),result.push({type:$(`#${tr.id} td select`)[0].value,ids:ids})}),final_group.value=result}}function delete_group(id){let e=document.querySelector(`#group${id}`);e.remove(),update_group()}function validate_type(e){["match","conflict","added"].includes(e.value)?(e.classList.add("is-valid"),e.classList.remove("is-invalid"),update_group()):(e.classList.add("is-invalid"),e.classList.remove("is-valid"))}function validate_ids(e){e.value||(e.classList.add("is-invalid"),e.classList.remove("is-valid"));let ids=e.value.split(",");ids.every(isNormalInteger)?(e.classList.add("is-valid"),e.classList.remove("is-invalid"),update_group()):(e.classList.add("is-invalid"),e.classList.remove("is-valid"))}function add_group(){let table=document.querySelector("#group_table"),tr=document.createElement("tr");tr.id=`group${group_counter}`,tr.innerHTML=`<td></td><td><div class="input-group has-validation"><select class="form-select" name="${group_counter}_type" onchange="validate_type(this)"><option disabled selected>--</option><option value="match">Match</option><option value="conflict">Conflict</option><option value="added">Added</option></select><div class="invalid-feedback">Please select a valid type.</div></div></td><td><div class="input-group has-validation"><input type="text" class="form-control" required name="${group_counter}_ids"pattern="^\d+(,\d+)*$" onchange="validate_ids(this)"placeholder="Pleas separate the ids by a comma(,), ex: 1,2,5"><div class="invalid-feedback">Please fill the field with the correct pattern.</div></div></td><td><button type="button" class="btn btn-sm btn-danger" style="background-color: #dc3545"onclick=delete_group(${group_counter})>X</button></td>`,table.appendChild(tr),group_counter+=1}group_counter=0,$(document).ready(()=>{add_group(),update_group()});